<header class="site-header">
    <nav class="nav-bar site-header__nav navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a href="/" class="site-header__logo-link">
                <img class="scanapi-logo site-header__logo" src="{{ "/assets/images/logo-white-on-transparent.png" | relative_url }}"/>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse site-header__collapse justify-content-end" id="navbar-collapse">
                <ul class="navbar-nav site-nav mb-2 mb-lg-0">
                    {% for item in site.data.navigation %}
                        <li class="site-nav__item">
                            {%- assign is_current = false -%}
                            {%- if page.url == item.link -%}
                                {%- assign is_current = true -%}
                            {%- elsif page.layout == 'docs' and item.link == '/docs.html' -%}
                                {%- assign is_current = true -%}
                            {%- elsif page.layout == 'tutorial' and item.name == 'Tutorial' -%}
                                {%- assign is_current = true -%}
                            {%- elsif page.layout == 'community' and item.link == '/community.html' -%}
                                {%- assign is_current = true -%}
                            {%- endif -%}
                            <a href="{{ item.link | relative_url}}" class="nav-item site-nav__link{% if is_current %} current{% endif %}">{{ item.name }}</a>
                        </li>
                    {% endfor %}

                    <li class="site-nav__item site-nav__item--dropdown">
                        <a class="nav-item site-nav__link site-nav__link--dropdown" href="#" role="button">
                            Resources
                            <svg class="site-nav__dropdown-icon" width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </a>
                        <ul class="site-nav__dropdown">
                            <li><a class="site-nav__dropdown-link" href="https://github.com/scanapi/examples" target="_blank">
                                <span class="site-nav__dropdown-icon-wrapper">ðŸ“š</span>
                                <span class="site-nav__dropdown-text">
                                    <strong>Examples</strong>
                                    <small>Sample API specifications</small>
                                </span>
                            </a></li>
                            <li><a class="site-nav__dropdown-link" href="https://github.com/marketplace/actions/scanapi" target="_blank">
                                <span class="site-nav__dropdown-icon-wrapper">âš¡</span>
                                <span class="site-nav__dropdown-text">
                                    <strong>GitHub Action</strong>
                                    <small>CI/CD integration</small>
                                </span>
                            </a></li>
                            <li><a class="site-nav__dropdown-link" href="https://marketplace.visualstudio.com/items?itemName=ScanAPI.scanapi" target="_blank">
                                <span class="site-nav__dropdown-icon-wrapper">ðŸ”Œ</span>
                                <span class="site-nav__dropdown-text">
                                    <strong>VSCode Plugin</strong>
                                    <small>Editor extension</small>
                                </span>
                            </a></li>
                        </ul>
                    </li>

                    <li class="site-nav__item site-nav__item--divider"></li>

                    <li class="site-nav__item">
                        <a class="nav-item site-nav__icon-link" href="https://twitter.com/scanapi_" target="_blank" aria-label="Twitter">
                            <img class="site-nav__icon" src="{{ "/assets/images/twitter.svg" | relative_url }}" alt="Twitter">
                        </a>
                    </li>
                    <li class="site-nav__item">
                        <a class="nav-item site-nav__icon-link" href="https://github.com/scanapi/scanapi" target="_blank" aria-label="GitHub">
                            <img class="site-nav__icon" src="{{ "/assets/images/github-logo.svg" | relative_url }}" alt="GitHub">
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<script>
// Dropdown e menu mobile (sem dependÃªncia de Bootstrap JS)
document.addEventListener('DOMContentLoaded', function() {
    // Dropdown Resources
    const dropdownToggle = document.querySelector('.site-nav__link--dropdown');
    const dropdownItem = document.querySelector('.site-nav__item--dropdown');

    if (dropdownToggle && dropdownItem) {
        dropdownToggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            dropdownItem.classList.toggle('active');
        });
    }

    // Menu mobile: abre/fecha colapso
    const toggler = document.querySelector('.navbar-toggler');
    const collapse = document.getElementById('navbar-collapse');

    function closeMenu() {
        if (!collapse) return;
        collapse.classList.remove('show');
        if (toggler) {
            toggler.classList.remove('is-open');
            toggler.setAttribute('aria-expanded', 'false');
        }
        document.body.classList.remove('no-scroll');
    }

    if (toggler && collapse) {
        toggler.addEventListener('click', function(e) {
            e.preventDefault();
            const willOpen = !collapse.classList.contains('show');
            collapse.classList.toggle('show');
            toggler.classList.toggle('is-open');
            toggler.setAttribute('aria-expanded', willOpen ? 'true' : 'false');
            document.body.classList.toggle('no-scroll', willOpen);
        });

        // Fechar ao clicar num link do menu
        collapse.addEventListener('click', function(e) {
            const target = e.target;
            if (target && (target.classList.contains('site-nav__link') || target.classList.contains('site-nav__dropdown-link'))) {
                closeMenu();
            }
        });

        // Clique fora fecha dropdown e menu
        document.addEventListener('click', function(e) {
            if (dropdownItem && !dropdownItem.contains(e.target)) {
                dropdownItem.classList.remove('active');
            }
            if (!collapse.contains(e.target) && !toggler.contains(e.target)) {
                closeMenu();
            }
        });

        // ESC fecha
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeMenu();
            }
        });
    }
});
</script>
